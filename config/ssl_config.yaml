# üîí SSL/TLS CONFIGURA√á√ÉO - OMNƒ∞ KEYWORDS FINDER
# üìÖ Criado: 2025-01-27
# üîß Tracing ID: CHECKLIST_99_PERCENT_20250127_001
# üéØ Objetivo: Configura√ß√£o enterprise-grade SSL/TLS

# =============================================================================
# üö® CONFIGURA√á√ÉO CR√çTICA DE SEGURAN√áA
# =============================================================================

ssl_tls:
  version: "1.3"  # TLS 1.3 obrigat√≥rio
  minimum_version: "1.2"  # Suporte m√≠nimo
  cipher_suite: "modern"  # Cipher suites modernos
  certificate_authority: "lets_encrypt"  # ou "digicert", "comodo"
  auto_renewal: true
  hsts_enabled: true
  hsts_max_age: 31536000  # 1 ano
  hsts_include_subdomains: true
  hsts_preload: true

# =============================================================================
# üìú CERTIFICADOS SSL/TLS
# =============================================================================

certificates:
  primary:
    domain: "omni-keywords-finder.com"
    certificate_file: "/etc/ssl/certs/omni-keywords-finder.com.crt"
    private_key_file: "/etc/ssl/private/omni-keywords-finder.com.key"
    certificate_chain_file: "/etc/ssl/certs/omni-keywords-finder.com.chain.crt"
    full_chain_file: "/etc/ssl/certs/omni-keywords-finder.com.fullchain.crt"
    
  wildcard:
    domain: "*.omni-keywords-finder.com"
    certificate_file: "/etc/ssl/certs/wildcard.omni-keywords-finder.com.crt"
    private_key_file: "/etc/ssl/private/wildcard.omni-keywords-finder.com.key"
    
  api:
    domain: "api.omni-keywords-finder.com"
    certificate_file: "/etc/ssl/certs/api.omni-keywords-finder.com.crt"
    private_key_file: "/etc/ssl/private/api.omni-keywords-finder.com.key"
    
  cdn:
    domain: "cdn.omni-keywords-finder.com"
    certificate_file: "/etc/ssl/certs/cdn.omni-keywords-finder.com.crt"
    private_key_file: "/etc/ssl/private/cdn.omni-keywords-finder.com.key"

# =============================================================================
# üîê CONFIGURA√á√ïES DE CHAVES
# =============================================================================

key_configuration:
  algorithm: "RSA"
  key_size: 4096  # M√≠nimo 2048, recomendado 4096
  key_format: "PEM"
  passphrase_protected: true
  key_rotation_interval: "90d"  # Rota√ß√£o a cada 90 dias

# =============================================================================
# üõ°Ô∏è CONFIGURA√á√ïES DE SEGURAN√áA AVAN√áADA
# =============================================================================

security_settings:
  # Cipher Suites (TLS 1.3)
  cipher_suites:
    - "TLS_AES_256_GCM_SHA384"
    - "TLS_CHACHA20_POLY1305_SHA256"
    - "TLS_AES_128_GCM_SHA256"
  
  # Cipher Suites (TLS 1.2 - Fallback)
  cipher_suites_tls12:
    - "ECDHE-RSA-AES256-GCM-SHA384"
    - "ECDHE-RSA-AES128-GCM-SHA256"
    - "ECDHE-RSA-AES256-SHA384"
    - "ECDHE-RSA-AES128-SHA256"
  
  # Curves ECDHE
  elliptic_curves:
    - "X25519"
    - "P-256"
    - "P-384"
  
  # Configura√ß√µes de Sess√£o
  session_ticket_lifetime: 300  # 5 minutos
  session_cache_size: 10000
  session_timeout: 300  # 5 minutos

# =============================================================================
# üîç CONFIGURA√á√ïES DE OCSP
# =============================================================================

ocsp:
  enabled: true
  responder_url: "http://ocsp.int-x3.letsencrypt.org"
  stapling_enabled: true
  stapling_cache_timeout: 3600  # 1 hora
  stapling_response_timeout: 5  # 5 segundos

# =============================================================================
# üìã CONFIGURA√á√ïES DE VALIDA√á√ÉO
# =============================================================================

validation:
  # Valida√ß√£o de Certificado
  certificate_validation: true
  certificate_revocation_check: true
  certificate_chain_validation: true
  
  # Valida√ß√£o de Nome
  hostname_validation: true
  wildcard_validation: true
  
  # Valida√ß√£o de Tempo
  certificate_expiry_warning: 30  # Dias antes do vencimento
  certificate_expiry_critical: 7  # Dias antes do vencimento

# =============================================================================
# üîÑ CONFIGURA√á√ïES DE RENOVA√á√ÉO AUTOM√ÅTICA
# =============================================================================

auto_renewal:
  enabled: true
  provider: "certbot"  # ou "acme.sh"
  renewal_window: 30  # Dias antes do vencimento
  renewal_attempts: 3
  renewal_interval: 86400  # 24 horas
  
  # Configura√ß√µes do Certbot
  certbot:
    email: "admin@omni-keywords-finder.com"
    agree_tos: true
    staging: false  # false para produ√ß√£o
    webroot_path: "/var/www/html/.well-known/acme-challenge"
    post_hook: "/etc/ssl/renewal/post-renewal.sh"

# =============================================================================
# üåê CONFIGURA√á√ïES DE REDIRECIONAMENTO
# =============================================================================

redirects:
  http_to_https: true
  www_to_non_www: true
  non_www_to_www: false
  redirect_status_code: 301  # Permanent redirect
  
  # Dom√≠nios para redirecionamento
  redirect_domains:
    - "www.omni-keywords-finder.com"
    - "http://omni-keywords-finder.com"
    - "http://www.omni-keywords-finder.com"

# =============================================================================
# üîß CONFIGURA√á√ïES DE SERVIDOR WEB
# =============================================================================

web_server:
  nginx:
    ssl_protocols: "TLSv1.2 TLSv1.3"
    ssl_ciphers: "ECDHE-RSA-AES256-GCM-SHA384:ECDHE-RSA-AES128-GCM-SHA256"
    ssl_prefer_server_ciphers: true
    ssl_session_cache: "shared:SSL:10m"
    ssl_session_timeout: "10m"
    ssl_stapling: true
    ssl_stapling_verify: true
    
  apache:
    ssl_protocol: "all -SSLv2 -SSLv3 -TLSv1 -TLSv1.1"
    ssl_cipher_suite: "EECDH+AESGCM:EDH+AESGCM"
    ssl_honor_cipher_order: true
    ssl_session_cache: "shmcb:/var/cache/mod_ssl/scache(512000)"
    ssl_session_timeout: 300

# =============================================================================
# üìä CONFIGURA√á√ïES DE MONITORAMENTO
# =============================================================================

monitoring:
  # Verifica√ß√£o de Certificado
  certificate_expiry_monitoring: true
  certificate_validation_monitoring: true
  ocsp_monitoring: true
  
  # Alertas
  expiry_warning_days: 30
  expiry_critical_days: 7
  validation_failure_alert: true
  ocsp_failure_alert: true
  
  # M√©tricas
  ssl_handshake_time: true
  certificate_validation_time: true
  ocsp_response_time: true

# =============================================================================
# üö® CONFIGURA√á√ïES DE EMERG√äNCIA
# =============================================================================

emergency:
  # Certificado de Backup
  backup_certificate:
    enabled: true
    certificate_file: "/etc/ssl/certs/backup.omni-keywords-finder.com.crt"
    private_key_file: "/etc/ssl/private/backup.omni-keywords-finder.com.key"
    auto_fallback: true
  
  # Procedimentos de Emerg√™ncia
  emergency_procedures:
    - "1. Verificar status do certificado: openssl x509 -in cert.crt -text -noout"
    - "2. Verificar conectividade SSL: openssl s_client -connect domain:443"
    - "3. For√ßar renova√ß√£o: certbot renew --force-renewal"
    - "4. Reiniciar servi√ßos web: systemctl reload nginx"
    - "5. Verificar logs: tail -f /var/log/nginx/error.log"

# =============================================================================
# üîç CONFIGURA√á√ïES DE TESTE
# =============================================================================

testing:
  # Ferramentas de Teste
  ssl_labs_test: true
  ssllabs_api_key: "your_ssllabs_api_key_here"
  test_frequency: "weekly"
  
  # Testes Autom√°ticos
  automated_tests:
    - "openssl s_client -connect omni-keywords-finder.com:443 -servername omni-keywords-finder.com"
    - "curl -I https://omni-keywords-finder.com"
    - "nmap --script ssl-enum-ciphers -p 443 omni-keywords-finder.com"
    - "testssl.sh omni-keywords-finder.com"
  
  # Crit√©rios de Aprova√ß√£o
  approval_criteria:
    ssl_labs_grade: "A+"  # M√≠nimo A
    certificate_validity: "valid"
    ocsp_stapling: "enabled"
    hsts: "enabled"
    perfect_forward_secrecy: "enabled"

# =============================================================================
# üìù CONFIGURA√á√ïES DE LOGS
# =============================================================================

logging:
  ssl_log_level: "info"
  ssl_log_file: "/var/log/ssl/ssl.log"
  ssl_error_log: "/var/log/ssl/ssl_error.log"
  log_ssl_handshakes: true
  log_certificate_errors: true
  log_ocsp_errors: true

# =============================================================================
# üéØ CONFIGURA√á√ïES ESPEC√çFICAS DO DOM√çNIO
# =============================================================================

domain_specific:
  omni_keywords_finder_com:
    certificate_type: "multi_domain"
    san_domains:
      - "omni-keywords-finder.com"
      - "www.omni-keywords-finder.com"
      - "api.omni-keywords-finder.com"
      - "cdn.omni-keywords-finder.com"
    redirects:
      - from: "http://omni-keywords-finder.com"
        to: "https://omni-keywords-finder.com"
      - from: "http://www.omni-keywords-finder.com"
        to: "https://omni-keywords-finder.com"

# =============================================================================
# üìã CHECKLIST DE VALIDA√á√ÉO SSL/TLS
# =============================================================================

validation_checklist:
  - "‚úÖ Certificado v√°lido e n√£o expirado"
  - "‚úÖ Cadeia de certificados completa"
  - "‚úÖ Chave privada protegida"
  - "‚úÖ TLS 1.3 habilitado"
  - "‚úÖ Cipher suites modernos configurados"
  - "‚úÖ HSTS habilitado"
  - "‚úÖ OCSP Stapling habilitado"
  - "‚úÖ Redirecionamento HTTP para HTTPS"
  - "‚úÖ Certificado de backup configurado"
  - "‚úÖ Monitoramento de expira√ß√£o ativo"
  - "‚úÖ Testes SSL Labs com nota A+"
  - "‚úÖ Logs SSL configurados"
  - "‚úÖ Procedimentos de emerg√™ncia documentados"
  - "‚úÖ Renova√ß√£o autom√°tica configurada"
  - "‚úÖ Valida√ß√£o de hostname ativa"

# =============================================================================
# ‚ö†Ô∏è AVISOS IMPORTANTES
# =============================================================================

warnings:
  - "Manter chaves privadas seguras e com permiss√µes restritas (600)"
  - "Nunca commitar certificados ou chaves privadas no Git"
  - "Monitorar logs de SSL regularmente"
  - "Configurar alertas para expira√ß√£o de certificados"
  - "Testar renova√ß√£o autom√°tica em ambiente de staging"
  - "Manter backup seguro dos certificados"
  - "Documentar procedimentos de emerg√™ncia"
  - "Treinar equipe em seguran√ßa SSL/TLS"
  - "Auditar configura√ß√µes SSL regularmente"
  - "Implementar rota√ß√£o de certificados" 